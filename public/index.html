<html lang="es">
  <head>
    <meta charset="utf-8" />
    <link rel="shortcut icon" href="%PUBLIC_URL%/public/static/img/home-medical.ico"> 
    <!-- Google Font: Source Sans Pro -->
    <link
      rel="stylesheet"
      href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback"
    />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    <!-- Font Awesome -->
    <link
      rel="stylesheet"
      href="%PUBLIC_URL%/plugins/fontawesome-free/css/all.min.css"
    />
    <!-- Ionicons -->
   
    <!-- Tempusdominus Bootstrap 4 -->
    <link
      rel="stylesheet"
      href="%PUBLIC_URL%/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css"
    />
    <!-- iCheck -->
    <link
      rel="stylesheet"
      href="%PUBLIC_URL%/plugins/icheck-bootstrap/icheck-bootstrap.min.css"
    />
    <!-- Theme style -->
    <link rel="stylesheet" href="%PUBLIC_URL%/static/css/adminlte.min.css" />
    <!-- overlayScrollbars -->
    <link rel="stylesheet" href="%PUBLIC_URL%/plugins/overlayScrollbars/css/OverlayScrollbars.min.css"/>
    <!-- Daterange picker -->
    <link
      rel="stylesheet"
      href="%PUBLIC_URL%/plugins/daterangepicker/daterangepicker.css"
    />
    <link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet" />
  
    
    <!-- summernote -->
    <link rel="stylesheet" href="plugins/summernote/summernote-bs4.min.css" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#000000" />
    <meta
      name="description"
      content="Web site created using create-react-app"
    />
    
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    
   
    
    <!-- <link
      rel="stylesheet"
      href="%PUBLIC_URL%/fontawesomefree/js/all.min.js"
    /> -->
    <!-- Theme style -->

    <link rel="stylesheet" href="%PUBLIC_URL%/plugins/fontawesome-free/css/all.min.css">
    <!-- daterange picker -->
    <link rel="stylesheet" href="%PUBLIC_URL%/plugins/daterangepicker/daterangepicker.css">
    <!-- iCheck for checkboxes and radio inputs -->
    <link rel="stylesheet" href="%PUBLIC_URL%/plugins/icheck-bootstrap/icheck-bootstrap.min.css">
    <!-- Bootstrap Color Picker -->
    <link rel="stylesheet" href="%PUBLIC_URL%/plugins/bootstrap-colorpicker/css/bootstrap-colorpicker.min.css">
    <!-- Tempusdominus Bootstrap 4 -->
    <link rel="stylesheet" href="%PUBLIC_URL%/plugins/tempusdominus-bootstrap-4/css/tempusdominus-bootstrap-4.min.css">
   
    <!-- BS Stepper -->
  <link rel="stylesheet" href="%PUBLIC_URL%/plugins/bs-stepper/css/bs-stepper.min.css">

  
    <!-- dropzonejs -->
    <title></title>
  </head>
  
  <body class="hold-transition sidebar-mini layout-fixed">
    <noscript>You need to enable JavaScript to run this app.</noscript>
    <div id="root">
      <div class="wrapper">
        
      </div>
    </div>
    
    
    <!-- jQuery -->
    <script src="%PUBLIC_URL%/plugins/jquery/jquery.min.js"></script>
    <!-- jQuery UI 1.11.4 -->
    <!-- <script src="%PUBLIC_URL%/plugins/jquery-ui/jquery-ui.min.js"></script> -->
    <!-- Resolve conflict in jQuery UI tooltip with Bootstrap tooltip -->
    <!-- <script>
      $.widget.bridge("uibutton", $.ui.button);
    </script> -->
    <!-- Bootstrap 4 -->
    <script src="%PUBLIC_URL%/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
    <!-- ChartJS -->
    <script src="%PUBLIC_URL%/plugins/chart.js/Chart.min.js"></script>
    <!-- Sparkline -->
    <script src="%PUBLIC_URL%/plugins/sparklines/sparkline.js"></script>
    <!-- JQVMap -->
    <!-- <script src="%PUBLIC_URL%/plugins/jqvmap/jquery.vmap.min.js"></script>
    <script src="%PUBLIC_URL%/plugins/jqvmap/maps/jquery.vmap.usa.js"></script> -->
    <!-- jQuery Knob Chart -->
    <!-- <script src="%PUBLIC_URL%/plugins/jquery-knob/jquery.knob.min.js"></script> -->
    <!-- daterangepicker -->
    <script src="%PUBLIC_URL%/plugins/moment/moment.min.js"></script>
    <script src="%PUBLIC_URL%/plugins/daterangepicker/daterangepicker.js"></script>
    <!-- Tempusdominus Bootstrap 4 -->
    <script src="%PUBLIC_URL%/plugins/tempusdominus-bootstrap-4/js/tempusdominus-bootstrap-4.min.js"></script>
    <!-- Summernote -->
    <script src="%PUBLIC_URL%/plugins/summernote/summernote-bs4.min.js"></script>
    <!-- overlayScrollbars -->
    <!-- <script src="%PUBLIC_URL%/plugins/overlayScrollbars/js/jquery.overlayScrollbars.min.js"></script> -->
    <!-- AdminLTE App -->
    <script src="%PUBLIC_URL%/static/js/adminlte.js"></script>
    <!-- AdminLTE for demo purposes -->
    <script src="%PUBLIC_URL%/static/js/demo.js"></script>
   
    <script src="%PUBLIC_URL%/plugins/jszip/jszip.min.js"></script>
    <script src="%PUBLIC_URL%/plugins/pdfmake/pdfmake.min.js"></script>
    <script src="%PUBLIC_URL%/plugins/pdfmake/vfs_fonts.js"></script>
  
    
    <!-- BS-Stepper -->
    <script src="%PUBLIC_URL%/plugins/bs-stepper/js/bs-stepper.min.js"></script>
    <!-- select2 -->
    <script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>
    <script src="https://unpkg.com/xlsx@latest/dist/xlsx.full.min.js"></script>
    <script src="https://unpkg.com/file-saverjs@latest/FileSaver.min.js"></script>
    <!-- <script src="https://unpkg.com/tableexport@latest/dist/js/tableexport.min.js"></script> -->
    <!-- <script src="%PUBLIC_URL%/../public/static/js/jspdf.debug.js"></script> -->
    
  <script>
    const Mod=(a,b)=>{
      
      let formED = document.getElementById('formED');

      $.ajax({
        type: "DELETE", 
        url:`${document.getElementById('root').placeholder}/api/incapacidades/${a}`,
        success:function(json_data) { 
          let  status_p
          if(json_data[0]['status_p']){
            status_p = '1'
          }else{
            status_p = '0'
          }
          document.getElementById('usern').innerHTML = json_data[0]['exp_nombres_apellidos']
          formED.cod.value=json_data[0]['exp_codigo_alternativo']
          formED.cod.id=a
          // 
          
          formED.date_from.value=json_data[0]['date_from1']
          formED.date_to.value=json_data[0]['date_to1']
          formED.days.value=json_data[0]['days']
          formED.condition.value=json_data[0]['condition']
          formED.status_p.value=status_p
          formED.date_p.value=json_data[0]['date_p1']
          formED.days_p.value=json_data[0]['days_p']
          formED.type_date.value=json_data[0]['type_date']
          formED.diagnostic.value=json_data[0]['diagnostic']
        }
      })
    } 

    const Reporte_Incapacidades_persona=(a,b)=>{
      // console.log(a+'\n'+b)
      window.open(`http://sjysrv02/ReportServer/Pages/ReportViewer.aspx?%2fAPCLIN_REPORT%2fReporteIncapacidadEmpleado&rs:Command=Render&rs:embed=true&rc:Parameters=false&id_patienty=${a}`,'_blank');
    }    

    const Reporte_Firma_persona=(a,b)=>{
      // console.log(a+'\n'+b)
      window.open(`http://sjysrv02/ReportServer/Pages/ReportViewer.aspx?%2fAPCLIN_REPORT%2fReporteFirma&rs:Command=Render&rs:embed=true&rc:Parameters=false&id_patienty=${a}`,'_blank');
      
    }

    var p = document.getElementById('idempres')
  // select de empresa
  if (p != null){
      let options = document.querySelectorAll('#idempres option');
          options.forEach(o => o.remove());
      $.ajax({
          type: "GET", 
          url: `http://${window.location.hostname}:5001/api/empresa`,
      
          success: function(json_data) {  
          const op = document.createElement('option') 
          op.value = ''
          op.text = '------ Seleccione -------'
          p.appendChild(op)
          if (json_data !== 'Not Data'){
              for (let i = 0; i < json_data.length; i++) {
                  const option = document.createElement('option')
                  option.value = json_data[i]['cia_codigo']
                  option.text = json_data[i]['cia_descripcion']+'-'+json_data[i]['cia_abreviatura']
                  p.appendChild(option);
              }
          }
          }
      })
  }

  $(document).ready(function() {
    $('.js-data-example3').select2({
      width:'60%',
    });
    $('.js-data-example2').select2({
      width:'70%',
    });
    $('.js-data-example').select2({
      width:'100%',
    });
    if(document.getElementById('root').value){
      let urlAPIS = document.getElementById('root').placeholder // url del servidor de las apis
      
      var em = document.getElementById('id_select_em')
      const selectEmployed=()=>{
        if (em != null){
          $.ajax({
            type: "GET", 
            url:`${urlAPIS}/api/empleados/${document.getElementById('root').value}`,
            success:function(json_data) {  
              const po = document.createElement('option')
              
              if(json_data === 'Not Data'){
                
                po.value = ''
                po.text = 'No data'
                // op.disabled = true
                em.appendChild(po)
              }else{ 
                po.value = ''
                po.text = '------ Seleccione -------'
                em.appendChild(po)
                for (let i = 0; i < json_data.length; i++) {
                  const option = document.createElement('option')
                  option.value = json_data[i]['exp_codigo_alternativo']
                  option.text = json_data[i]['exp_codigo_alternativo']+' '+json_data[i]['exp_nombres_apellidos']+' | '+json_data[i]['departamento']
                  em.appendChild(option);
                }
              }
            }
          })
        }
      }
      selectEmployed()


      var Co = document.getElementById('id_select_co')
      const selectCondition=()=>{
        if (Co != null){
          $.ajax({
            type: "GET", 
            url:`${urlAPIS}/api/condicion/${document.getElementById('root').value}`,
            success:function(json_data) {  
              const po = document.createElement('option')
              
              if(json_data === 'Not Data'){
                
                po.value = ''
                po.text = 'No data'
                // op.disabled = true
                Co.appendChild(po)
              }else{ 
                po.value = ''
                po.text = '------ Seleccione -------'
                Co.appendChild(po)
                for (let i = 0; i < json_data.length; i++) {
                  const option = document.createElement('option')
                  option.value = json_data[i]['id_Condition']
                  option.text = json_data[i]['id_Condition']+' '+json_data[i]['Condition']//+' | '+json_data[i]['departamento']
                  Co.appendChild(option);
                }
              }
            }
          })
        }
      }
      selectCondition()

      var s = document.getElementById('id_select_lote')
      const selectLot=()=>{
        if (s != null){
          $.ajax({
            type: "GET", 
            url:`${urlAPIS}/api/lot/${document.getElementById('root').value}`,
            success:function(json_data) {
              
              const op = document.createElement('option') 
              if(json_data === 'Not Data'){
                
                op.value = ''
                op.text = 'No existen lotes creados'
                // op.disabled = true
                s.appendChild(op)
              }else{
                op.value = ''
                op.text = '------ Seleccione -------'
                s.appendChild(op)
                for (let i = 0; i < json_data.length; i++) {
                  const option = document.createElement('option')
                  option.value = json_data[i]['cod_lot']
                  option.text = json_data[i]['cod_lot']
                  s.appendChild(option);
                }
              }
            }
          })
        }
      }
      selectLot()
    
      
      var p = document.getElementById('id_select_pro')
      const selectProd=()=>{
        if (p != null){
          $.ajax({
            type: "GET", 
            url:`${urlAPIS}/api/productos`,
            success:function(json_data) {  
              const op = document.createElement('option')
              if(json_data === 'Not Data'){
                
                op.value = ''
                op.text = 'No existen productos agregados'
                // op.disabled = true
                p.appendChild(op)
              }else{
                op.value = ''
                op.text = '------ Seleccione -------'
                p.appendChild(op)
                for (let i = 0; i < json_data.length; i++) {
                  const option = document.createElement('option')
                  option.value = json_data[i]['cod_prod']
                  option.text = json_data[i]['cod_prod']+' | '+json_data[i]['name_product']+' | '+json_data[i]['full_name']+'-'+json_data[i]['unid_med']+'-'+json_data[i]['description_typeP']
                  p.appendChild(option);
                }
            }
            }
          })
        }
      }
      selectProd()

      var ps = document.getElementById('id_select_pros')
      const selectProds=()=>{
        if (ps != null){
          $.ajax({
            type: "GET", 
            url:`${urlAPIS}/api/DetalleLot/${document.getElementById('root').value}`,
            success:function(json_data) {  
              const po = document.createElement('option') 
              if(json_data === 'Not Data'){
                po.value = ''
                po.text = 'No se han agregado productos a lotes'
                ps.appendChild(po)
              }else{
                po.value = ''
                po.text = '------ Seleccione -------'
                ps.appendChild(po)
                for (let i = 0; i < json_data.length; i++) {
                  const option = document.createElement('option')
                  option.value = json_data[i]['id']
                  option.text = json_data[i]['cod_prod']+' | '+json_data[i]['product']+'  Lote-'+json_data[i]['cod_lot']
                  option.title = json_data[i]['cod_lot']
                  option.name = json_data[i]['cod_prod']
                  ps.appendChild(option);
                }
              }
            }
          })
        }
      }
      selectProds()
     

      var st = document.getElementById('select_al')
      const selectStor=()=>{
        if (st != null){
          $.ajax({
            type: "GET", 
            url:`${urlAPIS}/api/almacen/${document.getElementById('root').value}`,
            success:function(json_data) { 
              
              const op = document.createElement('option') 
              if(json_data === 'Not Data'){
                
                op.value = ''
                op.text = 'No existen almacenes creados'
                
                st.appendChild(op)
              }else{
                op.value = ''
                op.text = '------ Seleccione -------'
                st.appendChild(op)
                for (let i = 0; i < json_data.length; i++) {
                  const option = document.createElement('option')
                  option.value = json_data[i]['detail_store']
                  option.text = json_data[i]['detail_store']+' '+json_data[i]['cia_abreviatura']+'-'+json_data[i]['cia_descripcion']
                  st.appendChild(option);
                }
            }
            }
          })
        }
      }
      selectStor()

   

      var tm = document.getElementById('select_tm')
      const selectTmov=()=>{
        if (tm != null){
          $.ajax({
            type: "GET", 
            url:`${urlAPIS}/api/tipo_movimiento`,
            success:function(json_data) {  
              const po = document.createElement('option') 
              if (json_data !== 'Not Data'){

                po.value = ''
                po.text = '------ Seleccione -------'
                tm.appendChild(po)
                for (let i = 0; i < json_data.length; i++) {
                  const option = document.createElement('option')
                  option.value = json_data[i]['id']
                  option.text = json_data[i]['cod_type_move']+'-'+json_data[i]['detail']
                  option.title = json_data[i]['option_move']
                  tm.appendChild(option);
                }
              }else{
                po.value = ''
                po.text = 'No existen registros'
                tm.appendChild(po);
              }
            }
          })
        }
      }
      selectTmov()
    
      var ls = document.getElementById('id_select_prost')
      const selectstock=()=>{
        if (ls != null){
          $.ajax({
            type: "GET", 
            url:`${urlAPIS}/api/stock/${document.getElementById('root').value}`,
            success:function(json_data) {  
              const po = document.createElement('option') 
              if (json_data !== 'Not Data'){

                po.value = ''
                po.text = '------ Seleccione -------'
                ls.appendChild(po)
                for (let i = 0; i < json_data.length; i++) {
                  const option = document.createElement('option')
                  option.value = json_data[i]['id']
                  option.text = json_data[i]['detail_store']+' || Lote-'+json_data[i]['cod_lot']+' | '+ json_data[i]['cod_prod']+' | '+json_data[i]['name_product']+' | Existencia '+json_data[i]['total_quantity']
                  option.title = json_data[i]['cod_lot']
                  option.name = json_data[i]['cod_prod']
                  option.placeholder = json_data[i]['detail_store']
                  option.role = json_data[i]['total_quantity']
                  ls.appendChild(option);
                }
                
              }else{
                  po.value = ''
                  po.text = 'No existen registros'
                  ls.appendChild(po);
              }
            }
          })
        }
      }
      selectstock()

    }else{
      console.log('no value')
    }
  });

    

    </script>
  </body>
</html>
